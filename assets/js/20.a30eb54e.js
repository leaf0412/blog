(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{479:function(t,s,a){"use strict";a.r(s);var e=a(4),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"_1、确保服务器安装pm2，没有安装的话先安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、确保服务器安装pm2，没有安装的话先安装"}},[t._v("#")]),t._v(" 1、确保服务器安装pm2，没有安装的话先安装")]),t._v(" "),a("p",[a("code",[t._v("npm install pm2 -g")])]),t._v(" "),a("h2",{attrs:{id:"_2、在本地项目根目录下新建一个deploy-yaml文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、在本地项目根目录下新建一个deploy-yaml文件"}},[t._v("#")]),t._v(" 2、在本地项目根目录下新建一个deploy.yaml文件")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("# deploy.yaml\napps:\n  - script: ./start.js       # 入口文件\n    name: 'app'              # 程序名称\n    env:                     # 环境变量\n      COMMON_VARIABLE: true\n    env_production:\n      NODE_ENV: production\n\ndeploy:                     # 部署脚本\n  production:               # 生产环境\n    user: lentoo            # 服务器的用户名\n    host: 192.168.2.166     # 服务器的ip地址\n    port: 22                # ssh端口\n    ref: origin/master      # 要拉取的git分支\n    ssh_options: StrictHostKeyChecking=no # SSH 公钥检查\n    repo: https://github.com/**.git # 远程仓库地址\n    path: /home              # 拉取到服务器某个目录下\n    pre-deploy: git fetch --all # 部署前执行\n    post-deploy: npm install &&  pm2 reload deploy.yaml --env production # 部署后执行\n    env:\n      NODE_ENV: production\n")])])]),a("h2",{attrs:{id:"_3、centos服务器上安装git，没有安装的话"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、centos服务器上安装git，没有安装的话"}},[t._v("#")]),t._v(" 3、centos服务器上安装git，没有安装的话")]),t._v(" "),a("p",[a("code",[t._v("yum install git -y")])]),t._v(" "),a("h2",{attrs:{id:"_4、生成ssh-密钥"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4、生成ssh-密钥"}},[t._v("#")]),t._v(" 4、生成ssh 密钥")]),t._v(" "),a("p",[t._v('```` ssh-keygen -t rsa -C "xx@oo.com" ```\n在~/.ssh目录下有id_rsa和id_rsa_pub两个文件，其中id_rsa_pub就是公钥key')]),t._v(" "),a("h2",{attrs:{id:"_5、登录到码云-github上面，点击头像，选择settings，点击add-ssh-key，把id-rsa-pub的内容复制到里面去"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5、登录到码云-github上面，点击头像，选择settings，点击add-ssh-key，把id-rsa-pub的内容复制到里面去"}},[t._v("#")]),t._v(" 5、登录到码云/GitHub上面，点击头像，选择settings，点击Add SSH key，把id_rsa_pub的内容复制到里面去")]),t._v(" "),a("h2",{attrs:{id:"_6、pm2-开始部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6、pm2-开始部署"}},[t._v("#")]),t._v(" 6、pm2 开始部署")]),t._v(" "),a("ul",[a("li",[t._v("首次部署\n"),a("ul",[a("li",[t._v("pm2 deploy deploy.yaml production setup")])])]),t._v(" "),a("li",[t._v("再次部署\n"),a("ul",[a("li",[t._v("pm2 deploy deploy.yaml production upddate")])])])])])}),[],!1,null,null,null);s.default=n.exports}}]);